# BookShelf REST API

![Go Version](https://img.shields.io/badge/go-1.20%2B-blue)
![License](https://img.shields.io/badge/license-MIT-green)
[![Swagger Docs](https://img.shields.io/badge/swagger-docs-brightgreen)](http://localhost:8080/swagger/index.html)

BookShelf - —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π RESTful API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–æ–º –∫–Ω–∏–≥ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –∏–∑–±—Ä–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–±–æ—Ä–∫–∞–º–∏ –∏ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –Ω–∞ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üõ°Ô∏è **JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** —Å —Ä–æ–ª–µ–≤–æ–π –º–æ–¥–µ–ª—å—é (user/admin)
- üìö **CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–Ω–∏–≥–∞–º–∏
- ‚ù§Ô∏è **–°–∏—Å—Ç–µ–º–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üìä **–ü–∞–≥–∏–Ω–∞—Ü–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** –∫–Ω–∏–≥ –ø–æ –∂–∞–Ω—Ä–∞–º
- üìù **Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –¥–ª—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- üöÄ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** –±–ª–∞–≥–æ–¥–∞—Ä—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—é Redis
- üê≥ **Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è** –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- ‚úÖ **–ü–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** (unit tests —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Testify)

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫**: Go 1.20+
- **–§—Ä–µ–π–º–≤–æ—Ä–∫**: Chi Router
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Redis
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: Swagger (Swaggo)
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: Docker, Docker Compose
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: JWT
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: Testify

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
/book-catalog
‚îú‚îÄ‚îÄ .env                  # Environment variables
‚îú‚îÄ‚îÄ docker-compose.yml    # Docker configuration
‚îú‚îÄ‚îÄ Dockerfile            # Go app build
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ main.go           # Entry point
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ models/           # DB models (GORM)
‚îÇ   ‚îú‚îÄ‚îÄ handlers/         # HTTP handlers
‚îÇ   ‚îú‚îÄ‚îÄ repository/       # DB operations
‚îÇ   ‚îú‚îÄ‚îÄ service/          # Business logic
‚îÇ   ‚îú‚îÄ‚îÄ config/           # App configuration
‚îÇ   ‚îî‚îÄ‚îÄ middleware/       # Auth and admin middleware
‚îú‚îÄ‚îÄ pkg/                  # Utility packages
‚îÇ   ‚îú‚îÄ‚îÄ utils/            # Response and JWT helpers
‚îÇ   ‚îî‚îÄ‚îÄ cache/            # Redis cache implementation
‚îî‚îÄ‚îÄ docs/                 # Generated Swagger docs
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- Go 1.20+ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–µ–∑ Docker)

### –ó–∞–ø—É—Å–∫ –±–µ–∑ Docker

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
go mod download
```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ PostgreSQL –∏ Redis –≤ Docker:
```bash
docker pull postgres
docker run --name bookshelf-container \
-e POSTGRES_DB=bookshelf_db \
-e POSTGRES_PASSWORD='yourpassword' \
-p 5433:5432 \
-d postgres
  
docker pull redis
docker run --name redis-container \  
-p 6379:6379 \
-d redis
```
3. –°–æ–∑–¥–∞–π—Ç–µ .env –ø–æ –æ–±—Ä–∞–∑—Ü—É:
```bash
PORT="8080"
DSN="host=localhost user=postgres password=yourpassword dbname=bookshelf_db port=5433 sslmode=disable"
JWT_SECRET="JWT_SECRET"
REDIS_URL="redis://localhost:6379"
```

4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
go run cmd/main.go
```

## API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç           | –û–ø–∏—Å–∞–Ω–∏–µ               | –î–æ—Å—Ç—É–ø    |
|-------|--------------------|------------------------|-----------|
| POST  | /auth/register     | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Public    |
| POST  | /auth/login        | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É         | Public    |

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç           | –û–ø–∏—Å–∞–Ω–∏–µ                     | –î–æ—Å—Ç—É–ø    |
|-------|--------------------|------------------------------|-----------|
| GET   | /users/me          | –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | User      |
| GET   | /users/{id}        | –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID  | User      |
| GET   | /users             | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  | Admin     |
| PUT   | /users/{id}/role   | –ò–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è   | Admin     |
| DELETE| /users/{id}        | –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è         | Admin     |

### –ö–Ω–∏–≥–∏

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç       | –û–ø–∏—Å–∞–Ω–∏–µ                     | –î–æ—Å—Ç—É–ø    |
|-------|----------------|------------------------------|-----------|
| GET   | /books         | –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π | Public    |
| GET   | /books/{id}    | –ü–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É –ø–æ ID         | Public    |
| GET   | /books/genres  | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∂–∞–Ω—Ä—ã           | Public    |
| POST  | /books         | –°–æ–∑–¥–∞—Ç—å –∫–Ω–∏–≥—É                | Admin     |
| PUT   | /books/{id}    | –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–∏–≥—É               | Admin     |
| DELETE| /books/{id}    | –£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É                | Admin     |

### –ò–∑–±—Ä–∞–Ω–Ω–æ–µ

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç              | –û–ø–∏—Å–∞–Ω–∏–µ                      | –î–æ—Å—Ç—É–ø    |
|-------|-----------------------|-------------------------------|-----------|
| GET   | /favourites           | –ü–æ–ª—É—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏      | User      |
| POST  | /favourites/{bookID}  | –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–∏–≥—É –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ    | User      |
| DELETE| /favourites/{bookID}  | –£–¥–∞–ª–∏—Ç—å –∫–Ω–∏–≥—É –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ   | User      |

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -X POST "http://localhost:8080/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"username":"new_user", "password":"strong_password"}'
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
```bash
curl -X POST "http://localhost:8080/auth/login" \
  -H "Content-Type: application/json" \
  -d '{"username":"new_user", "password":"strong_password"}'
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–∏–≥–∏ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
```bash
curl -X POST "http://localhost:8080/favourites/1" \
  -H "Authorization: Bearer <your_jwt_token>"
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–Ω–∏–≥ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
```bash
curl -X GET "http://localhost:8080/books?page=2&limit=10"
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ Swagger UI –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```
http://localhost:8080/swagger/index.html
```

![Swagger UI](https://raw.githubusercontent.com/swagger-api/swagger-ui/master/dist/favicon-32x32.png) [Swagger Documentation](http://localhost:8080/swagger/index.html)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
go test -v ./...
```

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- –•–µ–Ω–¥–ª–µ—Ä—ã API
- Middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É —Å–µ—Ä–≤–∏—Å–æ–≤
- –†–∞–±–æ—Ç—É —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Production

–î–ª—è production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PostgreSQL –∏ Redis –≤ managed-—Å–µ—Ä–≤–∏—Å–∞—Ö (AWS RDS, Elasticache –∏ —Ç.–¥.)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   - `DSN` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
   - `JWT_SECRET` - —Å–µ–∫—Ä–µ—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ JWT
   - `REDIS_URL` - URL –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Redis
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å reverse proxy (Nginx) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ HTTPS

## –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è –ø—É–ª-—Ä–µ–∫–≤–µ—Å—Ç—ã! –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏:

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É –¥–ª—è –≤–∞—à–µ–π —Ñ–∏—á–∏ (`git checkout -b feature/amazing-feature`)
3. –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è (`git commit -m 'Add some amazing feature'`)
4. –ó–∞–ø—É—à—å—Ç–µ –≤–µ—Ç–∫—É (`git push origin feature/amazing-feature`)
5. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—É–ª-—Ä–µ–∫–≤–µ—Å—Ç
